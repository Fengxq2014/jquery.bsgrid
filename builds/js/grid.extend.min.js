/**
* jQuery.bsgrid v1.30 by @Baishui2004
* Copyright 2014 Apache v2 License
* https://github.com/baishui2004/jquery.bsgrid
*/
(function(a){a.fn.bsgrid.defaults.extend.settings={supportGridEdit:false,supportGridEditTriggerEvent:"rowClick",supportColumnMove:false,searchConditionsContainerId:""};a.fn.bsgrid.defaults.colsProperties.checkAttr="w_check";a.fn.bsgrid.defaults.colsProperties.editAttr="w_edit";a.fn.bsgrid.extendInitGrid={};a.fn.bsgrid.extendBeforeRenderGrid={};a.fn.bsgrid.extendRenderPerRow={};a.fn.bsgrid.extendRenderPerColumn={};a.fn.bsgrid.extendAfterRenderGrid={};a.fn.bsgrid.extendInitGrid.bindExtendMethods=function(b,c){var d=a.fn.bsgrid.getGridObj(b);d.getCheckedRowsIndexs=function(){return a.fn.bsgrid.defaults.extend.getCheckedRowsIndexs(c)};d.getCheckedRowsRecords=function(){return a.fn.bsgrid.defaults.extend.getCheckedRowsRecords(c)};d.getChangedRowsIndexs=function(){return a.fn.bsgrid.defaults.extend.getChangedRowsIndexs(c)};d.getChangedRowsRecords=function(){return a.fn.bsgrid.defaults.extend.getChangedRowsRecords(c)};d.getChangedRowsNewRecords=function(){return a.fn.bsgrid.defaults.extend.getChangedRowsNewRecords(c)}};a.bsgrid.forcePushPropertyInObject(a.fn.bsgrid.defaults.extend.initGridMethods,"bindExtendMethods",a.fn.bsgrid.extendInitGrid.bindExtendMethods);a.fn.bsgrid.extendInitGrid.initGridCheck=function(b,c){a.fn.bsgrid.getGridHeaderObject(c).each(function(e){var d=a.trim(a(this).attr(c.settings.colsProperties.checkAttr));if(d=="true"){if(a.trim(a(this).html())==""){a(this).html('<input class="bsgrid_editgrid_check" type="checkbox"/>')}a(this).find("input[type=checkbox]").change(function(){if(a(this).attr("checked")){a("#"+b+" tr:not(:first)").each(function(){a(this).find("td:eq("+e+")>input[type=checkbox]").attr("checked",true)})}else{a("#"+b+" tr:not(:first)").each(function(){a(this).find("td:eq("+e+")>input[type=checkbox]").attr("checked",false)})}})}})};a.bsgrid.forcePushPropertyInObject(a.fn.bsgrid.defaults.extend.initGridMethods,"initGridCheck",a.fn.bsgrid.extendInitGrid.initGridCheck);a.fn.bsgrid.extendInitGrid.initSearchConditions=function(b,c){if(a.trim(c.settings.extend.settings.searchConditionsContainerId)==""){return}var e=new StringBuilder();e.append('<select class="bsgrid_conditions_select">');var f={};a.fn.bsgrid.getGridHeaderObject(c).each(function(){var g=a.trim(a(this).attr(c.settings.colsProperties.indexAttr));var h=a.trim(a(this).text());if(g!=""&&h!=""){f[g]=h}});for(var d in f){e.append('<option value="'+d+'">'+f[d]+"</option>")}e.append("</select>");e.append("&nbsp;");e.append('<input type="text" class="bsgrid_conditions_input" />');a("#"+c.settings.extend.settings.searchConditionsContainerId).html(e.toString());a("#"+c.settings.extend.settings.searchConditionsContainerId+" select.bsgrid_conditions_select:eq(0)").change(function(){a(this).next("input.bsgrid_conditions_input").attr("name",a(this).val())}).trigger("change")};a.bsgrid.forcePushPropertyInObject(a.fn.bsgrid.defaults.extend.initGridMethods,"initSearchConditions",a.fn.bsgrid.extendInitGrid.initSearchConditions);a.fn.bsgrid.extendInitGrid.initColumnMove=function(c,d){if(!d.settings.extend.settings.supportColumnMove){return}a("#"+d.gridId).css({"table-layout":"fixed"});var e=a.fn.bsgrid.getGridHeaderObject(d);var b=e.length;e.each(function(g){var h=this;a(h).mousedown(function(){f(h,g,b)});a(h).mousemove(function(){var q=a(h).offset().left;var n=0,o=0;if(g!=b-1){n=a(h).next();o=n.offset().left}var p=h;if(g!=b-1&&event.clientX-o>-10){p=n}if((g!=0&&event.clientX-q<10)||(g!=b-1&&event.clientX-o>-10)){a(h).css({cursor:"e-resize"});if(a.trim(a(h).data("ex_mousedown"))!="mousedown"){return}var l=a(p).width();var m=l-event.clientX+a(p).offset().left;var k=a(p).prev().width();var i=k+event.clientX-a(p).offset().left;if(parseInt(m)>19&&parseInt(i)>19){a(p).width(m).prev().width(i)}}else{a(p).css({cursor:"default"});j(h,g,b)}});a(h).mouseup(function(){j(h,g,b)});a(h).mouseout(function(){var i=a(h).offset();if(i.top>event.clientY||i.top+a(h).height()<event.clientY){j(h,g,b)}});function f(m,l,k){if(l!=0){a(m).prev().data("ex_mousedown","mousedown")}a(m).data("ex_mousedown","mousedown");if(l!=k-1){a(m).next().data("ex_mousedown","mousedown")}}function j(m,l,k){if(l!=0){a(m).prev().data("ex_mousedown","")}a(m).data("ex_mousedown","");if(l!=k-1){a(m).next().data("ex_mousedown","")}}})};a.bsgrid.forcePushPropertyInObject(a.fn.bsgrid.defaults.extend.initGridMethods,"initColumnMove",a.fn.bsgrid.extendInitGrid.initColumnMove);a.fn.bsgrid.extendRenderPerColumn.renderCheck=function(e,h,j,d,g,k){if(h<k.curPageRowsNum){var c=a.fn.bsgrid.getGridObj(k.gridId);var b=c.getColumnAttr(j,k.settings.colsProperties.checkAttr);var f=c.getColumnAttr(j,k.settings.colsProperties.indexAttr);var i=c.getColumnValue(h,f);if(b=="true"){return'<input class="bsgrid_editgrid_check" type="checkbox" value="'+i+'"/>'}}return false};a.bsgrid.forcePushPropertyInObject(a.fn.bsgrid.defaults.extend.renderPerColumnMethods,"renderCheck",a.fn.bsgrid.extendRenderPerColumn.renderCheck);a.fn.bsgrid.extendRenderPerColumn.renderForm=function(d,g,j,c,f,k){if(k.settings.extend.settings.supportGridEdit&&g<k.curPageRowsNum){var b=a.fn.bsgrid.getGridObj(k.gridId);var e=b.getColumnAttr(j,k.settings.colsProperties.indexAttr);var i=b.getColumnAttr(j,k.settings.colsProperties.editAttr);var h=b.getColumnValue(g,e);if(i=="checkbox"){return h+'<input class="bsgrid_editgrid_hidden bsgrid_editgrid_checkbox" type="'+i+'" value="'+h+'"/>'}else{if(i=="text"||i=="hidden"||i=="password"||i=="radio"||i=="button"){return h+'<input class="bsgrid_editgrid_hidden bsgrid_editgrid_edit" type="'+i+'" value="'+h+'"/>'}else{if(i=="textarea"){return h+'<textarea class="bsgrid_editgrid_hidden bsgrid_editgrid_edit">'+h+"</textarea>"}}}}return false};a.bsgrid.forcePushPropertyInObject(a.fn.bsgrid.defaults.extend.renderPerColumnMethods,"renderForm",a.fn.bsgrid.extendRenderPerColumn.renderForm);a.fn.bsgrid.extendAfterRenderGrid.addGridEditEvent=function(e,c,b){if(!b.settings.extend.settings.supportGridEdit){return}a("#"+b.gridId+" tr:not(:first):lt("+b.curPageRowsNum+")").each(function(f){var g=this;a(g).find("td").each(function(i){var l=a.fn.bsgrid.getGridObj(b.gridId);var h=l.getColumnAttr(i,b.settings.colsProperties.indexAttr);var j=l.getColumnAttr(i,b.settings.colsProperties.editAttr);var k=l.getColumnValue(f,h);if(j!=""){a(this).find(".bsgrid_editgrid_checkbox, .bsgrid_editgrid_edit").change(function(){if(a.trim(a(this).val())!=k){a(this).addClass("bsgrid_editgrid_change")}else{a(this).removeClass("bsgrid_editgrid_change")}a(g).data("change",a(g).find(".bsgrid_editgrid_change").length)})}});if(b.settings.extend.settings.supportGridEditTriggerEvent==""){a(this).find(".bsgrid_editgrid_hidden").each(function(){d(this)})}else{if(b.settings.extend.settings.supportGridEditTriggerEvent=="rowClick"){a(this).click(function(){a(this).find(".bsgrid_editgrid_hidden").each(function(){d(this)})})}else{if(b.settings.extend.settings.supportGridEditTriggerEvent=="rowDoubleClick"){a(this).dblclick(function(){a(this).find(".bsgrid_editgrid_hidden").each(function(){d(this)})})}else{if(b.settings.extend.settings.supportGridEditTriggerEvent=="cellClick"){a(this).find(".bsgrid_editgrid_hidden").each(function(){var h=this;a(h).parent("td").click(function(){d(h)})})}else{if(b.settings.extend.settings.supportGridEditTriggerEvent=="cellDoubleClick"){a(this).find(".bsgrid_editgrid_hidden").each(function(){var h=this;a(h).parent("td").dblclick(function(){d(h)})})}}}}}});function d(f){var g=a(f).removeClass("bsgrid_editgrid_hidden").clone(true);a(f).parent("td").html(g)}};a.bsgrid.forcePushPropertyInObject(a.fn.bsgrid.defaults.extend.afterRenderGridMethods,"addGridEditEvent",a.fn.bsgrid.extendAfterRenderGrid.addGridEditEvent);a.fn.bsgrid.defaults.extend.getCheckedRowsIndexs=function(b){var c=new Array();a("#"+b.gridId+" tr:not(:first)").each(function(d){if(a(this).find("td>input:checked").length==1){c[c.length]=d}});return c};a.fn.bsgrid.defaults.extend.getCheckedRowsRecords=function(c){var b=new Array();a.each(a.fn.bsgrid.defaults.extend.getCheckedRowsIndexs(c),function(d,e){b[b.length]=a.fn.bsgrid.getRecord(e,c)});return b};a.fn.bsgrid.defaults.extend.getChangedRowsIndexs=function(b){var c=new Array();a("#"+b.gridId+" tr:not(:first)").each(function(d){var e=a.trim(a(this).data("change"));if(!isNaN(e)&&parseInt(e)>0){c[c.length]=d}});return c};a.fn.bsgrid.defaults.extend.getChangedRowsRecords=function(c){var b=new Array();a.each(a.fn.bsgrid.defaults.extend.getChangedRowsIndexs(c),function(d,e){b[b.length]=a.fn.bsgrid.getRecord(e,c)});return b};a.fn.bsgrid.defaults.extend.getChangedRowsNewRecords=function(c){var b=new Array();a.each(a.fn.bsgrid.defaults.extend.getChangedRowsIndexs(c),function(d,e){b[b.length]=a.fn.bsgrid.getRecord(e,c)});return b}})(jQuery);